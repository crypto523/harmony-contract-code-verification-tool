# Harmony-One Contract Verification Tool

A verification contract tool which compares byte code written on an address with byte code compiled by the tool from source code provided as a Github link to a .sol file

## Dependencies

Install the (global) dependencies
```
yarn
npm
truffle
```
For Debian-based systems:
```bash
sudo apt install npm
sudo npm install --global npm yarn truffle
```

## Installation

Once the dependencies are installed, clone the repository and do a ``yarn build``
```bash
git clone https://github.com/MaxMustermann2/harmony-contract-code-verification-tool.git
cd harmony-contract-code-verification-tool/
yarn
yarn build
```

## Usage
Run ```yarn start --help``` to see the help options
```
Usage:  verify|v command <options>

(default) Verifies if the given contract address byte code matches that generated by the tool

Options:
  -ca, --contractAddress <contractAddress>  The address of the contract
  -sv, --solidityVersion <solidityVersion>  The version of the Solidity compiler which was used to compile the contract (at deployment)
  -gu, --githubURL <githubURL>              Github Repository URL, up to and including the *.sol file
  -ch, --commitHash <commitHash>            (optional) Hash of the commit to check out
  -k, --keep                                (optional,default=false) Keep the Github repository after the process
  -c, --chainType <chainType>               Chain type, for example, testnet or mainnet
  -h, --help                                display help for command
```

Run the below to verify a contract:
```bash
yarn start verify --contractAddress one16skweach8tqt0ce4a3x8jtuz0gtrn374vul3ua --githubURL https://github.com/harmony-one/metacoin-box/blob/master/contracts/MetaCoin.sol --chainType testnet --solidityVersion 0.5.16
```

## Tests
Simply run ```yarn test test/test.js --collectCoverage``` to view test coverage and results
```
------------|---------|----------|---------|---------|-------------------
File        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------|---------|----------|---------|---------|-------------------
All files   |   98.48 |    92.86 |     100 |   98.47 |                   
 github.ts  |   90.91 |       80 |     100 |   90.91 | 13,17             
 index.ts   |     100 |      100 |     100 |     100 |                   
 rpc.ts     |     100 |      100 |     100 |     100 |                   
 truffle.ts |     100 |      100 |     100 |     100 |                   
 verify.ts  |     100 |      100 |     100 |     100 |                   
------------|---------|----------|---------|---------|-------------------
```
